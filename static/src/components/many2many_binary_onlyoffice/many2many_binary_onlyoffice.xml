<?xml version="1.0" encoding="utf-8" ?>
<!--
    ONLYOFFICE Integration for Many2Many Binary Fields
    (c) 2024 RRDS
-->
<templates xml:space="preserve">
    <!-- Extend the attachment preview template to add ONLYOFFICE edit button -->
    <t t-inherit="web.Many2ManyBinaryField.attachment_preview" t-inherit-mode="extension">
        <!-- Add ONLYOFFICE edit button in the caption section after the download link -->
        <xpath expr="//div[hasclass('caption')]/a[@download]" position="after">
            <span
                t-if="editable and onlyofficeCanOpen(file)"
                class="o_attachment_onlyoffice"
                t-on-click.stop="() => this.openOnlyoffice(file)"
                title="Edit in ONLYOFFICE"
                style="cursor: pointer; margin-left: 8px;"
            >
                <img 
                    src="/onlyoffice_odoo/static/svg/edit.svg" 
                    role="img" 
                    aria-label="Edit in ONLYOFFICE"
                    style="width: 14px; height: 14px; vertical-align: middle;"
                />
            </span>
        </xpath>
    </t>
</templates>
