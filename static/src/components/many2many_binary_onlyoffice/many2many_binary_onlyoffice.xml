<?xml version="1.0" encoding="utf-8" ?>
<!--
    ONLYOFFICE Integration for Many2Many Binary Fields
    (c) 2024 RRDS
-->
<templates xml:space="preserve">
    <!-- Extend the attachment preview template to add ONLYOFFICE edit button -->
    <t t-inherit="web.Many2ManyBinaryField.attachment_preview" t-inherit-mode="extension">
        <!-- Add ONLYOFFICE edit button in the caption area, after the filename link -->
        <xpath expr="//div[hasclass('caption')]/a[1]" position="after">
            <a 
                t-if="editable and onlyofficeCanOpen(file)"
                href="#"
                class="o_attachment_onlyoffice"
                t-on-click.prevent="() => this.openOnlyoffice(file)"
                t-att-data-tooltip="'Edit in ONLYOFFICE'"
                style="margin-left: 6px; display: inline-block; vertical-align: middle;"
            >
                <img 
                    src="/onlyoffice_odoo/static/svg/edit.svg"
                    alt="Edit in ONLYOFFICE"
                    style="width: 14px; height: 14px; vertical-align: middle;"
                />
            </a>
        </xpath>
    </t>
</templates>
